graph TB
    %% External Users and Systems
    User[ğŸ‘¤ End Users]
    Admin[ğŸ‘¤ Administrators]
    DevOps[ğŸ‘¤ DevOps Engineers]
    External[ğŸ”— External Systems<br/>JIRA, Slack, Teams]

    %% DNS and CDN Layer
    User --> Route53[ğŸŒ Route 53<br/>DNS Management]
    Admin --> Route53
    Route53 --> CloudFront[ğŸš€ CloudFront CDN<br/>Global Distribution]

    %% Security Layer
    CloudFront --> WAF[ğŸ›¡ï¸ AWS WAF<br/>Web Application Firewall]
    WAF --> ALB[âš–ï¸ Application Load Balancer<br/>SSL Termination]

    %% VPC Network Layer
    subgraph VPC["ğŸ¢ AWS VPC (10.0.0.0/16)"]
        direction TB

        %% Public Subnets
        subgraph PublicSubnets["ğŸŒ Public Subnets (Multi-AZ)"]
            ALB
            NATGateway[ğŸšª NAT Gateway]
            IGW[ğŸŒ Internet Gateway]
        end

        %% Private Subnets
        subgraph PrivateSubnets["ğŸ”’ Private Subnets (Multi-AZ)"]
            direction TB

            %% EKS Cluster
            subgraph EKS["â˜¸ï¸ Amazon EKS Cluster"]
                direction TB

                %% System Namespaces
                subgraph SystemNS["ğŸ”§ System Namespaces"]
                    IstioSystem[ğŸ•¸ï¸ Istio Service Mesh<br/>Traffic Management & mTLS]
                    ArgoCD[ğŸ”„ ArgoCD<br/>GitOps Deployment]
                    CertManager[ğŸ” cert-manager<br/>Certificate Management]
                    ExternalSecrets[ğŸ”‘ External Secrets Operator<br/>AWS Secrets Integration]
                    VaultNS[ğŸ›ï¸ HashiCorp Vault<br/>Secret Management]
                end

                %% Monitoring Namespace
                subgraph MonitoringNS["ğŸ“Š Monitoring Stack"]
                    Prometheus[ğŸ“ˆ Prometheus<br/>Metrics Collection]
                    Grafana[ğŸ“Š Grafana<br/>Visualization & Dashboards]
                    Jaeger[ğŸ” Jaeger<br/>Distributed Tracing]
                    Kiali[ğŸ•·ï¸ Kiali<br/>Service Mesh Visualization]
                end

                %% Application Namespaces
                subgraph AppNS["ğŸš€ Application Services"]
                    direction TB

                    %% Frontend Services
                    subgraph Frontend["ğŸ¨ Frontend Applications"]
                        UICore[ğŸ§© UI Core<br/>Shared Components<br/>React/TypeScript]
                        Dashboard[ğŸ“Š Dashboard<br/>Main Interface<br/>React/TypeScript]
                        Findings[ğŸ” Findings<br/>Results Management<br/>React/TypeScript]
                        Analysis[âš¡ Analysis<br/>Workflow Interface<br/>React/TypeScript]
                    end

                    %% Backend Services
                    subgraph Backend["âš™ï¸ Backend Services"]
                        APIService[ğŸŒ API Service<br/>FastAPI Gateway<br/>Python]
                        ToolIntegration[ğŸ”§ Tool Integration<br/>Security Tools<br/>Python + Rust]
                        IntelligenceEngine[ğŸ§  Intelligence Engine<br/>ML & AI Analysis<br/>Python + Rust]
                        Orchestration[ğŸ¼ Orchestration<br/>Workflow Management<br/>Python/Celery]
                        DataService[ğŸ’¾ Data Service<br/>Database Layer<br/>Python + Rust]
                        Notification[ğŸ“¢ Notification<br/>Real-time Updates<br/>Node.js/TypeScript]
                        ContractParser[ğŸ“ Contract Parser<br/>Solidity Parsing<br/>Pure Rust]
                    end
                end

                %% Security Tools Namespace
                subgraph ToolsNS["ğŸ› ï¸ Security Tools"]
                    Slither[ğŸ Slither<br/>Python Static Analyzer]
                    Aderyn[ğŸ¦€ Aderyn<br/>Rust Static Analyzer]
                    MythX[ğŸ”® MythX<br/>Symbolic Execution]
                    SolidityMetrics[ğŸ“ Solidity-Metrics<br/>Code Metrics]
                end
            end

            %% AWS Managed Databases
            RDS[(ğŸ—„ï¸ Amazon RDS<br/>PostgreSQL 15<br/>Multi-AZ + Read Replicas)]
            ElastiCache[(âš¡ ElastiCache<br/>Redis Cluster<br/>Sharded + Multi-AZ)]
        end
    end

    %% AWS Storage Services
    subgraph Storage["ğŸ’½ AWS Storage Services"]
        S3Contract[ğŸ—‚ï¸ S3 Contracts<br/>Source Code Storage]
        S3Results[ğŸ“‹ S3 Results<br/>Analysis Results]
        S3Backup[ğŸ’¾ S3 Backups<br/>Database Backups]
        EFS[ğŸ“ EFS<br/>Shared File System]
    end

    %% AWS Security Services
    subgraph Security["ğŸ” AWS Security Services"]
        IAM[ğŸ‘¤ IAM<br/>Identity Management]
        SecretsManager[ğŸ”‘ Secrets Manager<br/>Credential Storage]
        KMS[ğŸ—ï¸ KMS<br/>Key Management]
        ACM[ğŸ“œ Certificate Manager<br/>SSL/TLS Certificates]
    end

    %% AWS Monitoring Services
    subgraph AWSMonitoring["ğŸ“Š AWS Monitoring"]
        CloudWatch[ğŸ“ˆ CloudWatch<br/>Metrics & Logs]
        CloudTrail[ğŸ“ CloudTrail<br/>Audit Logging]
        Config[âš™ï¸ AWS Config<br/>Configuration Compliance]
        GuardDuty[ğŸ›¡ï¸ GuardDuty<br/>Threat Detection]
    end

    %% Container Registry
    ECR[ğŸ“¦ Amazon ECR<br/>Container Registry<br/>Image Scanning]

    %% External Services
    subgraph ExternalServices["ğŸŒ External Services"]
        GitHub[ğŸ“š GitHub<br/>Source Code & CI/CD]
        Cloudflare[â˜ï¸ Cloudflare<br/>DNS & CDN]
        LetsEncrypt[ğŸ”’ Let's Encrypt<br/>SSL Certificates]
    end

    %% Service Connections
    ALB --> Frontend
    Frontend --> APIService
    APIService --> Backend

    %% Backend Service Interconnections
    APIService <--> DataService
    APIService <--> Orchestration
    Orchestration <--> ToolIntegration
    ToolIntegration <--> ToolsNS
    ToolIntegration <--> ContractParser
    IntelligenceEngine <--> DataService
    Orchestration <--> IntelligenceEngine
    Notification <--> APIService
    DataService <--> RDS
    DataService <--> ElastiCache

    %% Storage Connections
    ContractParser <--> S3Contract
    DataService <--> S3Results
    RDS <--> S3Backup
    EKS <--> EFS

    %% Security Connections
    EKS <--> IAM
    EKS <--> SecretsManager
    VaultNS <--> SecretsManager
    ExternalSecrets <--> SecretsManager
    ALB <--> ACM
    EKS <--> KMS

    %% Monitoring Connections
    EKS --> CloudWatch
    EKS --> CloudTrail
    EKS --> Config
    VPC --> GuardDuty
    Prometheus --> CloudWatch
    Grafana --> Prometheus
    Jaeger --> EKS

    %% CI/CD Connections
    GitHub --> ECR
    ECR --> ArgoCD
    ArgoCD --> EKS

    %% External Integrations
    Notification <--> External
    CertManager <--> LetsEncrypt
    Route53 <--> Cloudflare

    %% Infrastructure as Code
    DevOps --> GitHub
    GitHub --> ArgoCD

    %% Styling
    classDef aws fill:#FF9900,stroke:#333,stroke-width:2px,color:#fff
    classDef k8s fill:#326CE5,stroke:#333,stroke-width:2px,color:#fff
    classDef app fill:#4CAF50,stroke:#333,stroke-width:2px,color:#fff
    classDef frontend fill:#2196F3,stroke:#333,stroke-width:2px,color:#fff
    classDef backend fill:#FF5722,stroke:#333,stroke-width:2px,color:#fff
    classDef tools fill:#9C27B0,stroke:#333,stroke-width:2px,color:#fff
    classDef security fill:#F44336,stroke:#333,stroke-width:2px,color:#fff
    classDef monitoring fill:#FF9800,stroke:#333,stroke-width:2px,color:#fff
    classDef storage fill:#795548,stroke:#333,stroke-width:2px,color:#fff
    classDef external fill:#607D8B,stroke:#333,stroke-width:2px,color:#fff

    class Route53,ALB,WAF,CloudFront,RDS,ElastiCache,S3Contract,S3Results,S3Backup,EFS,IAM,SecretsManager,KMS,ACM,CloudWatch,CloudTrail,Config,GuardDuty,ECR aws
    class EKS,IstioSystem,ArgoCD,CertManager,ExternalSecrets,VaultNS k8s
    class APIService,DataService,Orchestration,IntelligenceEngine,ContractParser app
    class UICore,Dashboard,Findings,Analysis frontend
    class ToolIntegration,Notification backend
    class Slither,Aderyn,MythX,SolidityMetrics tools
    class Prometheus,Grafana,Jaeger,Kiali monitoring
    class GitHub,Cloudflare,LetsEncrypt,External external